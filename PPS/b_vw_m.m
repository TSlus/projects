% 12个控制点对应的样条函数b_i
% 对v, w采点
% clear;
% nEveryF = 10; % 每个面上采15个点
% nEveryF = 500; % 每个面上采120个点
nUV = ceil(sqrt(2 * nEveryF));  %ui,vi的个数
up = linspace(0,1,nUV);
upr = repmat(up,nUV,1);
uvPt(:,2) = upr(:);upr = upr';
uvPt(:,1) = upr(:);
[iu, ~] = find(uvPt(:,1) + uvPt(:,2) <= 1);
uvP = uvPt(iu,:); uvP(:,3) = 1 - uvP(:,1) - uvP(:,2);
eps = 1e-10;
uvP(uvP < eps) = 0;

v = uvP(:,1); w = uvP(:,2); u = uvP(:,3);
b_vw = [...
        ...% 第一项
        u.^4 + 2 * u.^3 .* v ,...
        ...% 第二项
        u.^4 + 2 * u.^3 .* w ,...
        ...% 第三项
        u.^4 + 2 * u.^3 .* w + 6 * u.^3 .* v + 6 * u.^2 .* v .* w + 12 * u.^2 .* v.^2 ...
        + 6 * u .* v.^2 .* w + 6 * u .* v.^3 + 2 * v.^3 .* w + v.^4 ,...
        ...% 第四项
        6*u.^4 + 24*u.^3.*w + 24*u.^2.*w.^2 + 8*u.*w.^3 + w.^4 + 24*u.^3.*v + 60*u.^2.*v.*w ...
        + 36*u.*v.*w.^2 + 6*v.*w.^3 + 24*u.^2.*v.^2 + 36*u.*v.^2.*w + 12*v.^2.*w.^2 + 8*u.*v.^3 ...
        + 6*v.^3.*w + v.^4 ,...
        ...% 第五项
        u.^4 + 6*u.^3.*w + 12*u.^2.*w.^2 + 6*u.*w.^3 + w.^4 + 2*u.^3.*v + 6*u.^2.*v.*w ...
        + 6*u.*v.*w.^2 + 2*v.*w.^3 ,...
        ...%第六项
        2*u.*v.^3 + v.^4 ,...
        ...% 第七项
        u.^4 + 6*u.^3.*w + 12*u.^2.*w.^2 + 6*u.*w.^3 + w.^4 + 8*u.^3.*v + 36*u.^2.*v.*w + 36*u.*v.*w.^2 ...
        + 8*v.*w.^3 + 24*u.^2.*v.^2 + 60*u.*v.^2.*w + 24*v.^2.*w.^2 + 24*u.*v.^3 + 24*v.^3.*w + 6*v.^4 ,...
        ...% 第八项
         u.^4 + 8*u.^3.*w + 24*u.^2.*w.^2 + 24*u.*w.^3 + 6*w.^4 + 6*u.^3.*v + 36*u.^2.*v.*w + 60*u.*v.*w.^2 ...
        + 24*v.*w.^3 + 12*u.^2.*v.^2 + 36*u.*v.^2.*w + 24*v.^2.*w.^2 + 6*u.*v.^3 + 8*v.^3.*w + v.^4 ,...
        ...% 第九项
        2*u.*w.^3 + w.^4 ,...
        ...% 第十项
        2*v.^3.*w + v.^4 ,...
        ...% 第十一项
        2*u.*w.^3 + w.^4 + 6*u.*v.*w.^2 + 6*v.*w.^3 + 6*u.*v.^2.*w + 12*v.^2.*w.^2 + 2*u.*v.^3 + 6*v.^3.*w + v.^4 ,...
        ...% 第十二项
        w.^4 + 2*v.*w.^3 ];
b_vw = b_vw/12;







